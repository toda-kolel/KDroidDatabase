# ğŸ“„ Application Policy **JSON** Contribution Guide

ğŸ’¡ **We accept pull requests *only* containing JSON policy files.** No Kotlin or sourceâ€‘code changes are required for a typical policy contribution.

---

## 1ï¸âƒ£Â JSONÂ Structures

Below are the three supported shapes.Â Choose the one that matches your useâ€‘case and copy the template.

### ğŸ·Â FixedPolicy

```jsonc
{
  "type": "Fixed",                 // required
  "packageName": "org.signal",
  "category": "COMMUNICATION",
  "minimumVersionCode": 0,
  "networkPolicy": {
    "mode": "WHITELIST",
    "spec": {
      "type": "HostList",
      "hosts": ["signal.org"]
    }
  }
}
```

### ğŸ”„Â ModeBasedPolicy

```jsonc
{
  "type": "ModeBased",
  "packageName": "com.whatsapp",
  "category": "COMMUNICATION",
  "minimumVersionCode": 0,
  "modePolicies": {
    "OFFLINE":  { "mode": "LOCAL_ONLY" },
    "GPS_ONLY": {
      "mode": "WHITELIST",
      "spec": { "type": "HostList", "hosts": ["whatsapp.com"] }
    },
    "MOST_OPEN": { "mode": "FULL_OPEN" }
  }
}
```

### ğŸ§©Â MultiModePolicy (with variants)

```jsonc
{
  "type": "MultiMode",
  "packageName": "com.youtube.tv",
  "category": "VIDEO",
  "minimumVersionCode": 123,
  "modeVariants": [
    {
      "userMode": "GPS_ONLY",
      "variants": [
        {
          "id": "strict",
          "label": "Strict (local only)",
          "policy": { "mode": "LOCAL_ONLY" }
        },
        {
          "id": "balanced",
          "label": "Balanced (whitelist)",
          "policy": {
            "mode": "WHITELIST",
            "spec": { "type": "HostList", "hosts": ["googlevideo.com"] }
          }
        }
      ],
      "defaultVariantId": "balanced"
    },
    {
      "userMode": "MOST_OPEN",
      "variants": [
        {
          "id": "open",
          "label": "Fully open",
          "policy": { "mode": "FULL_OPEN" }
        }
      ]
    }
  ]
}
```

---

## 2ï¸âƒ£Â Contribution ChecklistÂ ğŸ“‹

1. **Fork** the repository and create a feature branch.
2. Pick the template above that matches your needs.
3. Replace the placeholder values with real data.
4. **Validate** your JSON with [https://jsonlint.com/](https://jsonlint.com/) or any linter of your choice.
5. Save the file under:

   ```text
   app-policies/<category>/<packageName>.json
   ```
6. Commit ğŸ’¾Â **only the JSON file** and open a PR. Provide a clear title & description.

ğŸš¦Â *CI will fail if the file is not valid JSON or is placed in the wrong folder.*

---

## 3ï¸âƒ£Â Directory LayoutÂ ğŸ“‚

```
app-policies/
  communication/
    org.signal.json
  video/
    com.youtube.tv.json
  â€¦
```

Each category maps to its own folder for easier browsing and mergeâ€‘conflict avoidance.

---

## 4ï¸âƒ£Â BestÂ PracticesÂ ğŸ’¡

| âœ…Â Do                                       | ğŸš«Â Donâ€™t                                   |
| ------------------------------------------ | ------------------------------------------ |
| Use **2â€‘space indentation**                | Commit tabs or mixed spacing               |
| Keep keys in **lowerCamelCase**            | Add extra, undocumented keys               |
| Reâ€‘use **stable `id` values** for variants | Forceâ€‘push breaking changes without notice |
| Group related apps in one PR               | Mix unrelated apps & categories            |

---

## 5ï¸âƒ£Â Reference ValuesÂ ğŸ§­

**NetworkMode**: `FULL_OPEN`, `BLACKLIST`, `WHITELIST`, `LOCAL_ONLY`
**ModeSpec.type**: `None`, `HostList`
**UserMode**: `OFFLINE`, `LOCAL_ONLY`, `GPS_ONLY`, `GPS_AND_MAIL`, `REDUCED_RISK`, `MOST_OPEN`
**AppCategory** (excerpt): `COMMUNICATION`, `PRODUCTIVITY`, `VIDEO`, â€¦

---

### ğŸ’¬Â NeedÂ Help?

Open an issue or mention **@yourâ€‘team** in the PRâ€”responses within 24â€¯h. ğŸ™Œ
